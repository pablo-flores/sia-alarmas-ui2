
<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8">
        <meta name="author" content="pabflores@teco.com.ar">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Alarmas del Outage Manager</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}?v={{ timestamp }}">
        <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">

        <!-- Archivos CSS locales -->
        <link rel="stylesheet" href="{{ url_for('static', filename='vendor/css/jquery.dataTables.min.css') }}?v={{ timestamp }}">


        <!-- Archivos CSS locales 
        <link rel="stylesheet" href="{{ url_for('static', filename='vendor/css/jquery.dataTables.min.css') }}">-->
        <!-- Archivos JavaScript locales -->
        <!-- 
        <script src="{{ url_for('static', filename='vendor/js/jquery-3.6.0.min.js') }}"></script>
        <script src="{{ url_for('static', filename='vendor/js/jquery.dataTables.min.js') }}"></script>
    -->  
        
        <script src="{{ url_for('static', filename='vendor/js/jquery-3.6.0.min.js') }}?v={{ timestamp }}"></script>
        <script src="{{ url_for('static', filename='vendor/js/jquery.dataTables.min.js') }}?v={{ timestamp }}"></script>
        <script src="{{ url_for('static', filename='vendor/js/xlsx.full.min.js') }}?v={{ timestamp }}"></script>


        <!-- highlight.js JS 
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>-->
        <script src="{{ url_for('static', filename='vendor/js/highlight.min.js') }}?v={{ timestamp }}"></script>
        <script>hljs.highlightAll();</script>
    
        <script defer src="{{ url_for('static', filename='viewAlarmsOUM.js') }}"></script>        


    </head>


    <body>

        <div id="loading">
            <img src="static/1.gif" alt="Cargando..." style="width:100px; height:100px;">
            <p>Cargando datos de Alarmas del Outage Manager de los últimos {{ days_configMap }} días, por favor espere...</p>
        </div>
        

        <!-- Barra "Service Impact Analysis" con imagen -->
        <nav class="banner"> 
            <div class="service-impact-analysis">
                <img src="{{ url_for('static', filename='telecom.gif') }}" alt="Telecom Logo" class="logo">
                Service Impact Analysis
                <!-- Botón de expansión/contracción -->
                <button id="toggleButton" class="toggle-btn">Click para Explicación de columnas</button>   
                <div style='color: red; font-size: 0.8vw; font-weight: bold; text-align: right;'>Version 0.2.2 - EN PRUEBAS</div>   
                <div class="refresh-container">
                    <a href="javascript:(window.location.href = window.location.href)" class="btn-modern">Refresh - Foto: <span id="local-time"></span></a>        
                    <div id="progress-container">
                        <div id="progress-bar"></div>
                    </div>
                </div>
            </div> 
        </nav>
        

        <!-- Contenido Expandible -->
        <div id="expandableDiv" class="expandable-content" style="display: none;">

            <div class="grid-container">
                <div class="grid-itemRight">Primer Id Outage:</div> 
                <div class="grid-item"> Id del Outage (o Alarma), obtenido del primero en llegar al Outage Manager (TT o FMx).</div>
                
                <div class="grid-itemRight">Id Incidente:</div>         
                <div class="grid-item">Id de la ticketera o de Fault.</div>
                
                <div class="grid-itemRight">Estado:</div>           
                <div class="grid-item">Estado actual del outage.</div>
                
                <div class="grid-itemRight">Tipo de Alarma:</div>
                <div class="grid-item">Tipo de alarma (INDISPONIBILIDAD, DEGRADACION y TAREA_PROGRAMADA...).</div>                

                <div class="grid-itemRight">T.Inicio Detección:</div>  
                <div class="grid-item">Fecha y hora de 1er evento de Alarma (Fault) o creación manual.</div>
                
                <div class="grid-itemRight">T.Fin Alarma:</div>     
                <div class="grid-item">Fecha y hora que Fault desafectó la alarma, muestra los últimos {{ days_configMap }} días.</div>
                
                <div class="grid-itemRight">T.Raise Alarma:</div>
                <div class="grid-item">Fecha y hora que se reporto la afectación.</div>
                
                <div class="grid-itemRight">T-to Detect:</div>
                <div class="grid-item">Diferencia minutos entre T.Raise Alarma y T.Inicio Detección.</div>                
                
                <div class="grid-itemRight">T.Inicio Outage:</div>
                <div class="grid-item">Fecha y hora que llegó la afectación al Outage Manager.</div>

                <div class="grid-itemRight">T-to Outage:</div>
                <div class="grid-item">Diferencia minutos entre T.Inicio Outage y T.Inicio Detección.</div>                
                
                <div class="grid-itemRight">Tipo Elemento Red:</div>
                <div class="grid-item">Tipo de elemento de red asociado (RFS: Resource Facing Service, conjunto de recursos asociados a un nombre, para facilitar su gestión).</div>
                
                <div class="grid-itemRight">Id Elemento Red:</div>
                <div class="grid-item">Nombre del elemento de red donde aplicó el outage.</div>
                
                <div class="grid-itemRight">#Clientes:</div>
                <div class="grid-item">Cantidad de clientes afectados (clientes únicos).</div>
                
                <div class="grid-itemRight">TER:</div>
                <div class="grid-item">Tiempo Estimado de Resolución según tablas históricas.</div>

                <div class="grid-itemRight">notación con <sup style='color: red;'>*</sup> :</div>
                <div class="grid-item">identifica el campo que tiene busqueda sobre la base.</div>                
            </div>
            
        </div>

     
        <div class="page-content" style="position: relative; top: -10px;">

            <table id="alarmTable" style="display:none; margin: 0 3px; width: calc(100% - 6px);">
                <thead>
                    <tr>
                        <th style="font-size: 0.8vw; white-space: wrap; word-break: normal; text-align: center;">Primer Id Outage<sup style='color: red;'>*</sup></th>
                        <th style="font-size: 0.8vw; white-space: wrap; word-break: normal; text-align: center;">Id Incidente<sup style='color: red;'>*</sup></th>
                        <th style="font-size: 0.8vw; white-space: wrap; word-break: normal; text-align: center;">Estado<sup style='color: red;'>*</sup></th>
                        <th style="font-size: 0.8vw; white-space: wrap; word-break: normal; text-align: center;">Tipo de Alarma<sup style='color: red;'>*</sup></th>
                        <th style="font-size: 0.8vw; white-space: wrap; word-break: normal; text-align: center;">T.Inicio Detección</th> <!-- 1er deteccion Fault  -->
                        <th style="font-size: 0.8vw; white-space: wrap; word-break: normal; text-align: center;">T.Fin Alarma</th>
                        <th style="font-size: 0.8vw; white-space: wrap; word-break: normal; text-align: center;">T.Raise Alarma</th>
                        <th style="font-size: 0.8vw; white-space: wrap; word-break: normal; text-align: center;">T-to Detect</th> <!-- fin o creacion alarma deteccion Fault  -->                 
                        <th style="font-size: 0.8vw; white-space: wrap; word-break: normal; text-align: center;">T.Inicio Outage</th>
                        <th style="font-size: 0.8vw; white-space: wrap; word-break: normal; text-align: center;">T-to Outage</th>  <!-- llegada al outage  -->                 
                        <th style="font-size: 0.8vw; white-space: wrap; word-break: normal; text-align: center;">Tipo Elemento Red<sup style='color: red;'>*</sup></th>
                        <th style="font-size: 0.8vw; white-space: wrap; word-break: normal; text-align: center;">Id Elemento Red<sup style='color: red;'>*</sup></th>
                        <th style="font-size: 0.8vw; white-space: wrap; word-break: normal; text-align: center;">#Cli</th>
                        <th style="font-size: 0.8vw; white-space: wrap; word-break: normal; text-align: center;">TER</th>
                    </tr>       
                </thead>
                        
                <tbody>

                </tbody>
            </table>
        </div>    
    

        <!-- Mensaje de "Espere..." oculto al principio -->
        <div id="loading-message" style="display: none; position: fixed; top: 30%; left: 50%; transform: translate(-50%, -50%); background-color: rgba(0, 0, 0, 0.7); color: white; padding: 20px; border-radius: 10px; z-index: 9999;">
            <p>Espere, procesando descarga ...</p>
        </div>

        <!-- iframe invisible para manejar la descarga -->
        <iframe id="download-frame" style="display: none;"></iframe>
        <button id="download-csv" style="display: none;">Descargar CSV</button>
        <button id="download-excel" style="display: none;">Descargar CSV</button>

        <!-- Modal para mostrar los resultados de la búsqueda -->
        <div id="modal" class="modal">
            <div class="modal-content">
                <span id="close-modal" class="close">&times;</span>
                <h2>Resultados de la Búsqueda</h2>
                <div id="modal-content">
                    <!-- Contenedor para los resultados paginados -->
                    <div id="modal-results"></div>
                    <!-- Controles de paginación -->
                    <div id="pagination-controls" style="margin-top: 20px; text-align: center;">
                        <button id="prev-page" disabled>Anterior</button>
                        <span id="current-page">Página 1</span>
                        <button id="next-page">Siguiente</button>
                    </div>
                </div>
            </div>
        </div>



    </body>
</html>